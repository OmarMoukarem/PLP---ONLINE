<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Premier League Predictor – 2025/26</title>
<style>
body { font-family:sans-serif; margin:20px; }
header { text-align:center; margin-bottom:20px; }
.sub { font-size:0.9em; color:gray; }
.wrap { display:flex; flex-direction:column; gap:10px; }
.fixture { margin-bottom:10px; }
input { width:40px; }
select { padding:5px; margin-bottom:10px; }
button { margin-top:10px; padding:5px 10px; }
</style>
</head>
<body>

<header>
<h1>Premier League Predictor – 2025/26</h1>
<div class="sub">10 players • full 2025/26 fixtures • auto-scoring • Excel export • per-player predictions</div>
</header>

<label>Select Player: 
<select id="playerSelect"></select>
</label>

<div id="fixturesWrap" class="wrap"></div>
<button id="exportExcel">Export All Players to Excel</button>

<script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>

<script>
const PLAYERS=['Omar','Robbie','Khalil','Idriss','Aboudi','Masri','Hafez','Joseph','Rizk','Dani'];
const SAMPLE_FIXTURES=[
  {id:'1', gw:1, home:'Liverpool', away:'AFC Bournemouth'},
  {id:'2', gw:1, home:'Aston Villa', away:'Newcastle United'},
  {id:'3', gw:1, home:'Brighton & Hove Albion', away:'Fulham'},
  {id:'4', gw:1, home:'Sunderland', away:'West Ham United'},
  {id:'5', gw:1, home:'Tottenham Hotspur', away:'Burnley'},
  {id:'6', gw:1, home:'Wolverhampton Wanderers', away:'Manchester City'},
  {id:'7', gw:1, home:'Chelsea', away:'Crystal Palace'},
  {id:'8', gw:1, home:'Nottingham Forest', away:'Brentford'},
  {id:'9', gw:1, home:'Manchester United', away:'Arsenal'},
  {id:'10', gw:1, home:'Leeds United', away:'Everton'}
  // continue full season here
];

let currentPlayer = PLAYERS[0];
let predictions = {};

// --- Helper functions ---
function parseScore(s){if(!s)return null; const p=s.trim().split(/[-:xX]/); if(p.length!==2) return null; const a=parseInt(p[0],10),b=parseInt(p[1],10); if(isNaN(a)||isNaN(b)) return null; return {hg:a,ag:b};}

// Render player select dropdown
function renderPlayerSelect(){
  const sel = document.getElementById('playerSelect');
  sel.innerHTML = PLAYERS.map(p=>`<option value="${p}">${p}</option>`).join('');
  sel.value = currentPlayer;
  sel.addEventListener('change',()=>{
    saveCurrentPredictions();
    currentPlayer = sel.value;
    renderFixtures();
  });
}

// Load player predictions from Local Storage
function loadPredictions(){
  const saved = localStorage.getItem('plp_predictions');
  if(saved) predictions = JSON.parse(saved);
  else predictions = {};
}

// Save current player predictions
function saveCurrentPredictions(){
  SAMPLE_FIXTURES.forEach(f=>{
    const input=document.querySelector(`input[data-match="${f.id}"]`);
    if(input){
      predictions[currentPlayer]=predictions[currentPlayer]||{};
      predictions[currentPlayer][f.id]={score:input.value||''};
    }
  });
  localStorage.setItem('plp_predictions', JSON.stringify(predictions));
}

// Render fixtures with current player predictions
function renderFixtures(){
  const wrap=document.getElementById('fixturesWrap'); wrap.innerHTML='';
  SAMPLE_FIXTURES.forEach(f=>{
    const val = predictions[currentPlayer]?.[f.id]?.score || '';
    const div=document.createElement('div'); div.className='fixture';
    div.innerHTML=`<b>${f.home} vs ${f.away}</b> – <input placeholder="e.g. 2-1" data-match="${f.id}" value="${val}"/>`;
    wrap.appendChild(div);
  });
}

// Export all players to Excel
function exportToExcel(){
  saveCurrentPredictions();
  const ws_data=[['Player','Match','Home','Away','Prediction']];
  PLAYERS.forEach(p=>{
    SAMPLE_FIXTURES.forEach(f=>{
      const pred = predictions[p]?.[f.id]?.score || '';
      ws_data.push([p,f.id,f.home,f.away,pred]);
    });
  });
  const wb=XLSX.utils.book_new();
  const ws=XLSX.utils.aoa_to_sheet(ws_data);
  XLSX.utils.book_append_sheet(wb,ws,'Predictions');
  XLSX.writeFile(wb,'PLP_Predictions.xlsx');
}

// --- Init ---
document.addEventListener('DOMContentLoaded',()=>{
  loadPredictions();
  renderPlayerSelect();
  renderFixtures();
  document.getElementById('exportExcel').addEventListener('click',exportToExcel);
});
</script>

</body>
</html>